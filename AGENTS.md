# Repository Guidelines

YOU ARE THE MOST CAPABLE MODEL AND THIS PROJECT IS DIFFICULT META-PROGRAMMING THAT AVERAGE MODELS CANNOT HANDLE, WITH INTERLOCKING CONSTRAINTS WHERE A SINGLE MISSTEP BREAKS THE PIPELINE. IT DEMANDS INSIGHT BEYOND A TYPICAL PHD —- DO NOT TREAT IT LIGHTLY.

Authoritative instructions for coding agents working in this repo. Follow every constraint unless the user explicitly overrides it.

## Quick Start
- Read the user request twice; note unstated constraints and cross-file impacts.
- Plan when work is more than trivial and keep it updated; otherwise proceed directly.
- Inspect relevant files first with read-only commands (`rg`, `ls`, `cat`).
- Make focused, minimal edits; prefer patch-style changes or targeted scripts.
- Run only the needed validation via `uv run ...`; summarize results.
- Craft the final response using the messaging rules below, including verification status and next actions when relevant.

## Project Structure & Key Files
- `src/swarmx/` – Core package (`agent.py`, `cli.py`, `mcp_manager.py`, `utils.py`, `types.py`, `hook.py`).
- `tests/` – Pytest suite mirroring source (`test_agent.py`, `test_cli.py`, `test_mcp_manager.py`).
- `docs/`, `examples/` – Narrative docs and usage patterns.
- See `README.md` and `docs/` for deeper context.

## Workflow & Guardrails
- Plan for non-trivial tasks; keep plans current.
- Default to ASCII. Add concise comments only when they clarify complex logic. Never revert user-owned changes.
- Use `uv run <tool>` for targeted checks; mention skipped tests and why.
- Stay within provided access; request approval before privileged actions. Avoid destructive git commands.
- Surface failures promptly with relevant output and proposed alternatives.

## Command Reference
- Inspect: `ls`, `rg --files`, `rg "<pattern>" <path>`
- Format/lint: `uv run ruff check`, `uv run ruff format`
- Tests: `uv run pytest`, `uv run pytest -xvs`
- Scripts: `uv run <script>.py`
- Dependencies: `uv add <pkg>`, `uv remove <pkg>`, `uv sync`
- Editing: prefer patch-based tools or scripted transformations.

## Coding Style & Naming
- Target Python 3.12+; use modern generics (`class A[T]: ...`, `def func[P, R](p: P) -> R:`) and type hints throughout.
- Prefer concise, idiomatic Python; leverage built-ins and comprehensions.
- Google-style docstrings.
- Ruff is the source of truth for linting/formatting (configured in `pyproject.toml`).
- Use Pydantic models in `types.py` for validation.
- Pydantic config belongs in the class signature (e.g., `class Model(BaseModel, extra="allow")`), not `model_config`.
- Do **not** add `from __future__ import annotations` (or other `__future__` imports); Python 3.12+ already provides the needed behavior, and 3.14 removes the module.
- Naming: Classes `PascalCase`, functions/variables `snake_case`, constants `UPPER_SNAKE_CASE`.

## Testing
- pytest (with pytest-cov) is the framework of record; aim for >90% coverage.
- Mirror source structure; use fixtures and `pytest-asyncio` for async code.
- Prefer `uv run pytest -xvs` when debugging; share only salient failures.
- Always note whether tests ran, passed, or were skipped.

## Communication & Final Messages
- Tone: concise, collaborative, factual. Reference files with clickable paths (`path/to/file.py:42`).
- Lead with the outcome, then explain changes by file/section. Use bullets sparingly.
- Always state verification status (tests/linters run or skipped) and only suggest natural next steps.
- Do not dump large diffs; describe impact and locations for local inspection.

## Commit & PR Guidelines
- Commit messages: Keep ≤50 characters, imperative, using KeepAChangelog verbs (`Added`, `Changed`, `Deprecated`, `Removed`, `Fixed`, `Security`). Provide body when needed; never include “generated by LLM”.
- PRs: Describe changes clearly, link issues, ensure tests pass, update docs when required. Pre-commit hooks run `ruff` and `mypy`.

## Security & Configuration
- Environment variables load from `.env`; keep `.env.example` in sync.
- Never commit secrets or credentials.
- MCP servers require proper auth; keep configuration aligned with `mcp_manager.py`.
- See `DESIGNS.md` for detailed agent architecture, graph invariants, and MCP integration notes.

## Related Resources
- `README.md` – overview and getting started.
- `docs/` – extended guides and references.
- `examples/` – practical usage patterns.
